@using System.ComponentModel.DataAnnotations
@using System.Globalization
@using System.Text
@using System.Text.Json
@using System.Collections.Generic
@using Lagerhotell.Services.UserService
@using LagerhotellAPI.Models

@page "/log-in";

<AuthorizeView>
    <NotAuthorized>
    <LoginForm />
    </NotAuthorized>
    <Authorized>
        <MudPaper Elevation="3" Class="p-4">
            <MudText Typo="Typo.h5" GutterBottom>Du er allerede logget inn</MudText>
            <MudText>Velkommen tilbake! Du kan fortsette å bruke appen, eller logge ut om du ønsker det.</MudText>
            <MudButton Color="Color.Error" Variant="Variant.Filled" @onclick="LogOutUser" Class="mt-3">Logg ut</MudButton>
        </MudPaper>
    </Authorized>          
</AuthorizeView>

@inject HttpClient http
@inject NavigationManager navigationManager
@inject SessionService sessionService
@inject ISnackbar snackbar
@code {
    private LagerhotellAPI.Models.CheckPhoneNumber checkPhoneNumber = new LagerhotellAPI.Models.CheckPhoneNumber();
    private readonly UserServiceLogin userServiceLogin = new();
    public string PhoneNumberRegistered = "";
    public string ErrorMessage = "";

    protected override async Task OnInitializedAsync()
    {
        /* string jwtToken = await sessionService.GetJwtFromLocalStorage();
        if (jwtToken != null)
            {
            // decode token
        } */
    }

    public async void LogOutUser()
    {
        // Log out
    }
}
